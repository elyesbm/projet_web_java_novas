{% extends 'admin/base_admin.html.twig' %}

{% block title %}{{ mode == 'create' ? 'Nouvel' : 'Modifier' }} utilisateur - NOVAS Admin{% endblock %}
{% block page_title %}{{ mode == 'create' ? 'Nouvel utilisateur' : 'Modifier utilisateur' }}{% endblock %}
{% block page_subtitle %}{{ mode == 'create' ? 'Créer un nouveau compte' : 'Modifier les informations' }}{% endblock %}

{% block body %}
<div class="max-w-3xl mx-auto">
    <form class="space-y-6" onsubmit="event.preventDefault(); showToast('{{ mode == 'create' ? 'Utilisateur créé' : 'Modifications enregistrées' }}', 'success'); setTimeout(() => window.location.href = '{{ path('app_admin_users_list') }}', 1500);">
        
        {# Avatar #}
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-soft border border-slate-100 dark:border-slate-700 p-6">
            <div class="flex items-center gap-6">
                <div class="w-24 h-24 rounded-2xl bg-gradient-to-br from-primary-500 to-secondary-500 flex items-center justify-center text-white text-3xl font-bold">ND</div>
                <div>
                    <h4 class="font-semibold text-slate-900 dark:text-white mb-1">Photo de profil</h4>
                    <p class="text-sm text-slate-500 mb-3">JPG, PNG. Max 2MB.</p>
                    <button type="button" class="text-sm text-primary-600 hover:text-primary-700 font-medium">Changer la photo</button>
                </div>
            </div>
        </div>

        {# Informations #}
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-soft border border-slate-100 dark:border-slate-700 p-6">
            <h3 class="text-lg font-semibold text-slate-900 dark:text-white mb-6">Informations personnelles</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div class="space-y-2">
                    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300">Nom <span class="text-rose-500">*</span></label>
                    <input type="text" required class="w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary-500" placeholder="Dupont">
                </div>
                <div class="space-y-2">
                    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300">Prénom <span class="text-rose-500">*</span></label>
                    <input type="text" required class="w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary-500" placeholder="Marie">
                </div>
            </div>
            
            <div class="space-y-2 mb-6">
                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300">Email <span class="text-rose-500">*</span></label>
                <input type="email" required class="w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary-500" placeholder="marie.dupont@univ-lyon.fr">
            </div>
            
            <div class="space-y-2">
                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300">Niveau d'études</label>
                <select class="w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary-500">
                    <option>Licence 1</option>
                    <option>Licence 2</option>
                    <option>Licence 3</option>
                    <option>Master 1</option>
                    <option>Master 2</option>
                </select>
            </div>
        </div>

        {# Rôle #}
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-soft border border-slate-100 dark:border-slate-700 p-6">
            <h3 class="text-lg font-semibold text-slate-900 dark:text-white mb-6">Rôle et permissions</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <label class="relative flex cursor-pointer">
                    <input type="radio" name="role" value="etudiant" class="peer sr-only" checked>
                    <div class="w-full p-4 rounded-xl border-2 border-slate-200 dark:border-slate-700 peer-checked:border-primary-500 peer-checked:bg-primary-50 dark:peer-checked:bg-primary-900/20 hover:border-slate-300 transition-all">
                        <i data-lucide="user" class="w-6 h-6 mb-2 text-slate-400 peer-checked:text-primary-500"></i>
                        <p class="font-semibold text-slate-900 dark:text-white">Étudiant</p>
                    </div>
                </label>
                <label class="relative flex cursor-pointer">
                    <input type="radio" name="role" value="moderateur" class="peer sr-only">
                    <div class="w-full p-4 rounded-xl border-2 border-slate-200 dark:border-slate-700 peer-checked:border-primary-500 peer-checked:bg-primary-50 dark:peer-checked:bg-primary-900/20 hover:border-slate-300 transition-all">
                        <i data-lucide="shield-check" class="w-6 h-6 mb-2 text-slate-400 peer-checked:text-primary-500"></i>
                        <p class="font-semibold text-slate-900 dark:text-white">Modérateur</p>
                    </div>
                </label>
                <label class="relative flex cursor-pointer">
                    <input type="radio" name="role" value="admin" class="peer sr-only">
                    <div class="w-full p-4 rounded-xl border-2 border-slate-200 dark:border-slate-700 peer-checked:border-primary-500 peer-checked:bg-primary-50 dark:peer-checked:bg-primary-900/20 hover:border-slate-300 transition-all">
                        <i data-lucide="crown" class="w-6 h-6 mb-2 text-slate-400 peer-checked:text-primary-500"></i>
                        <p class="font-semibold text-slate-900 dark:text-white">Admin</p>
                    </div>
                </label>
            </div>
        </div>

        {# Mot de passe (création uniquement) #}
        {% if mode == 'create' %}
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-soft border border-slate-100 dark:border-slate-700 p-6">
            <h3 class="text-lg font-semibold text-slate-900 dark:text-white mb-6">Sécurité</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-2">
                    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300">Mot de passe <span class="text-rose-500">*</span></label>
                    <input type="password" required class="w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary-500" placeholder="••••••••">
                </div>
                <div class="space-y-2">
                    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300">Confirmation <span class="text-rose-500">*</span></label>
                    <input type="password" required class="w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary-500" placeholder="••••••••">
                </div>
            </div>
        </div>
        {% endif %}

        {# Actions #}
        <div class="flex items-center justify-between pt-6">
            <a href="{{ path('app_admin_users_list') }}" class="flex items-center gap-2 px-6 py-3 rounded-xl border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-600 dark:text-slate-300 font-medium">
                <i data-lucide="arrow-left" class="w-4 h-4"></i>
                Annuler
            </a>
            <button type="submit" class="flex items-center gap-2 px-8 py-3 rounded-xl bg-gradient-to-r from-primary-600 to-secondary-600 hover:from-primary-700 hover:to-secondary-700 text-white font-medium shadow-lg shadow-primary-500/25 transition-all">
                <i data-lucide="check" class="w-4 h-4"></i>
                {{ mode == 'create' ? 'Créer l\'utilisateur' : 'Enregistrer' }}
            </button>
        </div>
    </form>
</div>
{% endblock %}
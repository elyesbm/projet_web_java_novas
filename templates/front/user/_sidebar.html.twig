{# templates/user/_sidebar.html.twig #}
{% set current_route = app.request.attributes.get('_route') %}

<!-- Mobile Toggle -->
<button onclick="toggleSidebar()" class="fixed top-4 left-4 z-50 lg:hidden w-12 h-12 glass-card rounded-xl flex items-center justify-center">
    <i data-lucide="menu" class="w-6 h-6"></i>
</button>

<!-- Overlay -->
<div id="sidebarOverlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-30 lg:hidden hidden"></div>

<!-- Sidebar -->
<aside id="sidebar" class="fixed left-0 top-0 h-full w-72 glass-sidebar z-40 transition-transform duration-300 -translate-x-full lg:translate-x-0">
    <div class="flex flex-col h-full">
        <!-- Logo -->
        <div class="p-6 border-b border-white/5">
           <!-- Logo -->
<a href="{{ path('app_home') }}" class="flex items-center gap-3 group">
    <img src="{{ asset('images/logo.png') }}" alt="Novas" class="h-10 w-auto">
</a>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 p-4 space-y-1 overflow-y-auto">
            {% set navigation = [
                { name: 'Mon Profil', route: 'app_user_profile', icon: 'user' },
                { name: 'Mes Competences', route: 'app_skills_mes', icon: 'sparkles' },
                { name: 'Parcours', route: 'app_learning_paths_index', icon: 'book-open' },
                { name: 'Ateliers', route: 'app_reservation_ateliers', icon: 'calendar' },
                { name: 'Mes Reservations', route: 'app_reservation_mes', icon: 'ticket' },
                { name: 'Forum', route: 'app_publications_index', icon: 'message-square' },
            ] %}
            
            {% for item in navigation %}
                {% set isActive = current_route == item.route %}
                <a href="{{ path(item.route) }}" class="nav-item flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-all {{ isActive ? 'active bg-primary/10 text-primary' : 'text-muted-foreground hover:text-foreground hover:bg-white/5' }}">
                    <i data-lucide="{{ item.icon }}" class="w-5 h-5 {{ isActive ? 'animate-pulse' : '' }}"></i>
                    {{ item.name }}
                </a>
            {% endfor %}
        </nav>

        <!-- User Card -->
        <div class="p-4 border-t border-white/5">
            <div class="glass-card rounded-2xl p-4">
                <div class="flex items-center gap-3 mb-3">
                    <div class="relative">
                        <img src="{{ asset('images/student-avatar.jpg') }}" alt="Avatar" class="w-12 h-12 rounded-xl object-cover ring-2 ring-primary/30">
                        <div class="absolute -bottom-1 -right-1 w-4 h-4 rounded-full bg-accent border-2 border-background"></div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-semibold truncate">Sarah Martin</p>
                        <p class="text-xs text-muted-foreground">L3 Informatique</p>
                    </div>
                </div>
                <div class="flex gap-2">
                    <span class="px-2 py-1 bg-academic/20 text-academic text-xs rounded-lg font-medium">Academic</span>
                    <span class="px-2 py-1 bg-personal/20 text-personal text-xs rounded-lg font-medium">Personal</span>
                </div>
            </div>
            
            <!-- Logout -->
            <a href="{{ path('app_home') }}" class="flex items-center gap-3 px-4 py-3 mt-2 rounded-xl text-sm font-medium text-muted-foreground hover:text-red-400 hover:bg-red-500/10 transition-all">
                <i data-lucide="log-out" class="w-5 h-5"></i>
                Deconnexion
            </a>
        </div>
    </div>
</aside>

<script>
    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebarOverlay');
        sidebar.classList.toggle('-translate-x-full');
        overlay.classList.toggle('hidden');
    }
</script>
